{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.trading.example.com/decisions.order_intent.v1.json",
  "title": "Order Intent Decision",
  "description": "Trading decision generated by agent strategy indicating intent to place an order.",
  "version": "1.0.0",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "corr_id",
    "strategy_id",
    "agent_id",
    "timestamp",
    "instrument",
    "side",
    "order_type",
    "quantity",
    "confidence"
  ],
  "properties": {
    "corr_id": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9_-]+$",
      "minLength": 1,
      "maxLength": 128,
      "description": "Correlation ID carried through from signal processing."
    },
    "strategy_id": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9_-]+$",
      "minLength": 1,
      "maxLength": 64,
      "description": "Unique identifier for the strategy that generated this decision."
    },
    "agent_id": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9_-]+$",
      "minLength": 1,
      "maxLength": 64,
      "description": "Unique identifier for the agent instance."
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when decision was generated."
    },
    "instrument": {
      "type": "string",
      "pattern": "^[A-Z0-9]+([/_-]?[A-Z0-9]+)?$",
      "minLength": 3,
      "maxLength": 20,
      "description": "Trading instrument identifier (e.g., EURUSD, BTC/USD, ES_F).",
      "examples": ["EURUSD", "BTC/USD", "ES_F", "GLD"]
    },
    "side": {
      "type": "string",
      "enum": ["buy", "sell"],
      "description": "Direction of the intended order."
    },
    "order_type": {
      "type": "string",
      "enum": ["market", "limit", "stop", "stop_limit"],
      "description": "Type of order to be placed."
    },
    "quantity": {
      "type": "number",
      "exclusiveMinimum": 0,
      "description": "Order quantity/size."
    },
    "price": {
      "type": "number",
      "exclusiveMinimum": 0,
      "description": "Limit price (required for limit and stop_limit orders)."
    },
    "stop_price": {
      "type": "number",
      "exclusiveMinimum": 0,
      "description": "Stop trigger price (required for stop and stop_limit orders)."
    },
    "confidence": {
      "type": "number",
      "minimum": 0,
      "maximum": 1,
      "description": "Agent's confidence level in this decision (0-1)."
    },
    "reasoning": {
      "type": "string",
      "maxLength": 500,
      "description": "Optional explanation of the decision logic."
    },
    "risk_score": {
      "type": "number",
      "minimum": 0,
      "maximum": 10,
      "description": "Risk assessment score for this trade (0-10)."
    },
    "signal_refs": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "References to signal correlation IDs that influenced this decision."
    },
    "metadata": {
      "type": "object",
      "description": "Additional strategy-specific metadata.",
      "additionalProperties": true
    }
  },
  "if": {
    "properties": {
      "order_type": {
        "enum": ["limit", "stop_limit"]
      }
    }
  },
  "then": {
    "required": ["price"]
  },
  "examples": [
    {
      "corr_id": "req_abc123",
      "strategy_id": "momentum_breakout_v1",
      "agent_id": "agent_prod_001",
      "timestamp": "2024-01-15T10:31:00.123Z",
      "instrument": "EURUSD",
      "side": "buy",
      "order_type": "market",
      "quantity": 10000,
      "confidence": 0.85,
      "reasoning": "Strong bullish momentum detected with volume confirmation",
      "risk_score": 3.5,
      "signal_refs": ["sig_xyz789", "sig_def456"]
    }
  ]
}